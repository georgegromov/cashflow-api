# Use Cases (Прецеденты) проекта CashFlow API

## Описание проекта

CashFlow API — серверное приложение для управления личными финансами, позволяющее пользователям отслеживать доходы и расходы, управлять категориями и получать финансовую аналитику.

## Список Use Cases

### UC1: Регистрация пользователя (Sign Up)

**Описание:** Пользователь регистрируется в системе, создавая новый аккаунт.
**Актор:** Анонимный пользователь
**Предусловия:** Пользователь не зарегистрирован в системе
**Основной поток:**

1. Пользователь отправляет запрос на регистрацию с username и password
2. Система проверяет уникальность username
3. Система хеширует password
4. Система создает пользователя в БД
5. Система автоматически создает набор категорий по умолчанию для пользователя
6. Система возвращает JWT токен для авторизации

**Альтернативный поток:**

- 2a. Если username уже существует, система возвращает ошибку 400

### UC2: Вход в систему (Sign In)

**Описание:** Зарегистрированный пользователь входит в систему.
**Актор:** Зарегистрированный пользователь
**Предусловия:** Пользователь зарегистрирован в системе
**Основной поток:**

1. Пользователь отправляет запрос на вход с username и password
2. Система проверяет существование пользователя
3. Система проверяет корректность password
4. Система генерирует JWT токен
5. Система возвращает токен пользователю

**Альтернативный поток:**

- 2a. Если пользователь не найден, система возвращает ошибку 401
- 3a. Если password неверный, система возвращает ошибку 401

### UC3: Создание транзакции

**Описание:** Пользователь создает новую транзакцию (доход или расход).
**Актор:** Авторизованный пользователь
**Предусловия:** Пользователь авторизован в системе
**Основной поток:**

1. Пользователь отправляет запрос на создание транзакции с данными (amount, type, note, categoryId)
2. Система проверяет авторизацию пользователя
3. Если указана categoryId, система проверяет существование категории и принадлежность пользователю
4. Система создает транзакцию в БД
5. Система возвращает ID созданной транзакции

**Альтернативный поток:**

- 3a. Если категория не найдена или не принадлежит пользователю, система возвращает ошибку 400

### UC4: Просмотр списка транзакций

**Описание:** Пользователь получает список всех своих транзакций.
**Актор:** Авторизованный пользователь
**Предусловия:** Пользователь авторизован в системе
**Основной поток:**

1. Пользователь отправляет запрос на получение списка транзакций
2. Система проверяет авторизацию пользователя
3. Система загружает все транзакции пользователя из БД
4. Система сортирует транзакции по дате создания (новые первыми)
5. Система возвращает список транзакций

### UC5: Просмотр транзакции по ID

**Описание:** Пользователь получает детальную информацию о конкретной транзакции.
**Актор:** Авторизованный пользователь
**Предусловия:** Пользователь авторизован в системе
**Основной поток:**

1. Пользователь отправляет запрос на получение транзакции по ID
2. Система проверяет авторизацию пользователя
3. Система ищет транзакцию в БД
4. Система проверяет принадлежность транзакции пользователю
5. Система возвращает данные транзакции

**Альтернативный поток:**

- 4a. Если транзакция не найдена или не принадлежит пользователю, система возвращает ошибку 404

### UC6: Получение финансовой аналитики

**Описание:** Пользователь получает общую финансовую аналитику (доходы, расходы, баланс, аналитика по категориям).
**Актор:** Авторизованный пользователь
**Предусловия:** Пользователь авторизован в системе
**Основной поток:**

1. Пользователь отправляет запрос на получение финансовой аналитики (опционально с фильтрами по датам)
2. Система проверяет авторизацию пользователя
3. Система валидирует параметры дат (если указаны)
4. Система загружает транзакции пользователя с фильтрацией по датам
5. Система вычисляет общие доходы и расходы
6. Система вычисляет баланс (доходы - расходы)
7. Система группирует транзакции по категориям и вычисляет аналитику
8. Система возвращает финансовую аналитику

**Альтернативный поток:**

- 3a. Если даты невалидны или startDate > endDate, система возвращает ошибку 400

### UC7: Получение аналитики по категориям

**Описание:** Пользователь получает детальную аналитику по категориям (сумма, количество транзакций, процент от общей суммы).
**Актор:** Авторизованный пользователь
**Предусловия:** Пользователь авторизован в системе
**Основной поток:**

1. Пользователь отправляет запрос на получение аналитики по категориям (опционально с фильтрами по датам)
2. Система проверяет авторизацию пользователя
3. Система валидирует параметры дат (если указаны)
4. Система загружает транзакции пользователя с фильтрацией по датам
5. Система группирует транзакции по категориям
6. Система вычисляет для каждой категории: сумму, количество транзакций, процент от общей суммы
7. Система сортирует категории по сумме (от большей к меньшей)
8. Система возвращает аналитику по категориям

### UC8: Создание категории

**Описание:** Пользователь создает новую категорию для транзакций.
**Актор:** Авторизованный пользователь
**Предусловия:** Пользователь авторизован в системе
**Основной поток:**

1. Пользователь отправляет запрос на создание категории с данными (name, type)
2. Система проверяет авторизацию пользователя
3. Система проверяет уникальность имени категории для пользователя
4. Система создает категорию в БД
5. Система возвращает ID созданной категории

**Альтернативный поток:**

- 3a. Если категория с таким именем уже существует у пользователя, система возвращает ошибку 400

### UC9: Просмотр списка категорий

**Описание:** Пользователь получает список всех своих категорий.
**Актор:** Авторизованный пользователь
**Предусловия:** Пользователь авторизован в системе
**Основной поток:**

1. Пользователь отправляет запрос на получение списка категорий
2. Система проверяет авторизацию пользователя
3. Система загружает все категории пользователя из БД
4. Система возвращает список категорий

### UC10: Просмотр категории по ID

**Описание:** Пользователь получает детальную информацию о конкретной категории.
**Актор:** Авторизованный пользователь
**Предусловия:** Пользователь авторизован в системе
**Основной поток:**

1. Пользователь отправляет запрос на получение категории по ID
2. Система проверяет авторизацию пользователя
3. Система ищет категорию в БД
4. Система проверяет принадлежность категории пользователю
5. Система возвращает данные категории

**Альтернативный поток:**

- 4a. Если категория не найдена или не принадлежит пользователю, система возвращает ошибку 404

### UC11: Обновление категории

**Описание:** Пользователь обновляет данные существующей категории.
**Актор:** Авторизованный пользователь
**Предусловия:** Пользователь авторизован в системе, категория существует
**Основной поток:**

1. Пользователь отправляет запрос на обновление категории с новыми данными
2. Система проверяет авторизацию пользователя
3. Система ищет категорию в БД
4. Система проверяет принадлежность категории пользователю
5. Система обновляет данные категории
6. Система возвращает ID обновленной категории

**Альтернативный поток:**

- 4a. Если категория не найдена или не принадлежит пользователю, система возвращает ошибку 404

### UC12: Удаление категории

**Описание:** Пользователь удаляет категорию.
**Актор:** Авторизованный пользователь
**Предусловия:** Пользователь авторизован в системе, категория существует
**Основной поток:**

1. Пользователь отправляет запрос на удаление категории
2. Система проверяет авторизацию пользователя
3. Система ищет категорию в БД
4. Система проверяет принадлежность категории пользователю
5. Система удаляет категорию из БД
6. Система возвращает ID удаленной категории

**Альтернативный поток:**

- 4a. Если категория не найдена или не принадлежит пользователю, система возвращает ошибку 404

## Сводная таблица Use Cases

| №    | Название                          | Сложность | Приоритет | Статус      |
| ---- | --------------------------------- | --------- | --------- | ----------- |
| UC1  | Регистрация пользователя          | Средняя   | Высокий   | Реализовано |
| UC2  | Вход в систему                    | Низкая    | Высокий   | Реализовано |
| UC3  | Создание транзакции               | Средняя   | Высокий   | Реализовано |
| UC4  | Просмотр списка транзакций        | Низкая    | Высокий   | Реализовано |
| UC5  | Просмотр транзакции по ID         | Низкая    | Средний   | Реализовано |
| UC6  | Получение финансовой аналитики    | Высокая   | Высокий   | Реализовано |
| UC7  | Получение аналитики по категориям | Высокая   | Высокий   | Реализовано |
| UC8  | Создание категории                | Низкая    | Высокий   | Реализовано |
| UC9  | Просмотр списка категорий         | Низкая    | Высокий   | Реализовано |
| UC10 | Просмотр категории по ID          | Низкая    | Средний   | Реализовано |
| UC11 | Обновление категории              | Средняя   | Средний   | Реализовано |
| UC12 | Удаление категории                | Средняя   | Средний   | Реализовано |
